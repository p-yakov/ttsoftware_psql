create temp table if not exists temp_countries (name      text not null   --наименование
                                               ,parent_id int  not null); --идентификатор родителя
do $$
declare v_parent_id int := 0;
        elem        json;
        list        json := '[
  {"ru":"Афганистан","en":"AFG"},
  {"ru":"Аландские острова","en":"ALA"},
  {"ru":"Албания","en":"ALB"},
  {"ru":"Алжир","en":"DZA"},
  {"ru":"Американское Самоа","en":"ASM"},
  {"ru":"Андорра","en":"AND"},
  {"ru":"Ангола","en":"AGO"},
  {"ru":"Ангилья","en":"AIA"},
  {"ru":"Антарктика","en":"ATA"},
  {"ru":"Антигуа и Барбуда","en":"ATG"},
  {"ru":"Аргентина","en":"ARG"},
  {"ru":"Армения","en":"ARM"},
  {"ru":"Аруба","en":"ABW"},
  {"ru":"Австралия","en":"AUS"},
  {"ru":"Австрия","en":"AUT"},
  {"ru":"Азербайджан","en":"AZE"},
  {"ru":"Багамы","en":"BHS"},
  {"ru":"Бахрейн","en":"BHR"},
  {"ru":"Бангладеш","en":"BGD"},
  {"ru":"Барбадос","en":"BRB"},
  {"ru":"Беларусь","en":"BLR"},
  {"ru":"Бельгия","en":"BEL"},
  {"ru":"Белиз","en":"BLZ"},
  {"ru":"Бенин","en":"BEN"},
  {"ru":"Бермудские острова","en":"BMU"},
  {"ru":"Бутан","en":"BTN"},
  {"ru":"Боливия (Многонациональное Государство)","en":"BOL"},
  {"ru":"Бонэйр, Синт-Эстатиус и Саба","en":"BES"},
  {"ru":"Босния и Герцеговина","en":"BIH"},
  {"ru":"Ботсвана","en":"BWA"},
  {"ru":"Остров Буве","en":"BVT"},
  {"ru":"Бразилия","en":"BRA"},
  {"ru":"Британская территория в Индийском океане","en":"IOT"},
  {"ru":"Бруней-Даруссалам","en":"BRN"},
  {"ru":"Болгария","en":"BGR"},
  {"ru":"Буркина-Фасо","en":"BFA"},
  {"ru":"Бурунди","en":"BDI"},
  {"ru":"Кабо-Верде","en":"CPV"},
  {"ru":"Камбоджа","en":"KHM"},
  {"ru":"Камерун","en":"CMR"},
  {"ru":"Канада","en":"CAN"},
  {"ru":"Каймановы острова","en":"CYM"},
  {"ru":"Центрально-Африканская Республика","en":"CAF"},
  {"ru":"Чад","en":"TCD"},
  {"ru":"Чили","en":"CHL"},
  {"ru":"Китай","en":"CHN"},
  {"ru":"Остров Рождества","en":"CXR"},
  {"ru":"Кокосовые (Килинг) острова","en":"CCK"},
  {"ru":"Колумбия","en":"COL"},
  {"ru":"Коморы","en":"COM"},
  {"ru":"Конго","en":"COG"},
  {"ru":"Демократическая Республика Конго","en":"COD"},
  {"ru":"Острова Кука","en":"COK"},
  {"ru":"Коста-Рика","en":"CRI"},
  {"ru":"Хорватия","en":"HRV"},
  {"ru":"Куба","en":"CUB"},
  {"ru":"Кюрасао","en":"CUW"},
  {"ru":"Кипр","en":"CYP"},
  {"ru":"Чехия","en":"CZE"},
  {"ru":"Дания","en":"DNK"},
  {"ru":"Джибути","en":"DJI"},
  {"ru":"Доминика","en":"DMA"},
  {"ru":"Доминиканская Республика","en":"DOM"},
  {"ru":"Эквадор","en":"ECU"},
  {"ru":"Египет","en":"EGY"},
  {"ru":"Сальвадор","en":"SLV"},
  {"ru":"Экваториальная Гвинея","en":"GNQ"},
  {"ru":"Эритрея","en":"ERI"},
  {"ru":"Эстония","en":"EST"},
  {"ru":"Эсватини","en":"SWZ"},
  {"ru":"Эфиопия","en":"ETH"},
  {"ru":"Фолклендские (Мальвинские) острова","en":"FLK"},
  {"ru":"Фарерские острова","en":"FRO"},
  {"ru":"Фиджи","en":"FJI"},
  {"ru":"Финляндия","en":"FIN"},
  {"ru":"Франция","en":"FRA"},
  {"ru":"Французская Гвиана","en":"GUF"},
  {"ru":"Французская Полинезия","en":"PYF"},
  {"ru":"Южные территории Франции","en":"ATF"},
  {"ru":"Габон","en":"GAB"},
  {"ru":"Гамбия","en":"GMB"},
  {"ru":"Грузия","en":"GEO"},
  {"ru":"Германия","en":"DEU"},
  {"ru":"Гана","en":"GHA"},
  {"ru":"Гибралтар","en":"GIB"},
  {"ru":"Греция","en":"GRC"},
  {"ru":"Гренландия","en":"GRL"},
  {"ru":"Гренада","en":"GRD"},
  {"ru":"Гваделупа","en":"GLP"},
  {"ru":"Гуам","en":"GUM"},
  {"ru":"Гватемала","en":"GTM"},
  {"ru":"Гернси","en":"GGY"},
  {"ru":"Гвинея","en":"GIN"},
  {"ru":"Гвинея-Биссау","en":"GNB"},
  {"ru":"Гайана","en":"GUY"},
  {"ru":"Гаити","en":"HTI"},
  {"ru":"Остров Херд и острова Макдональд","en":"HMD"},
  {"ru":"Гондурас","en":"HND"},
  {"ru":"Гонконг","en":"HKG"},
  {"ru":"Венгрия","en":"HUN"},
  {"ru":"Исландия","en":"ISL"},
  {"ru":"Индия","en":"IND"},
  {"ru":"Индонезия","en":"IDN"},
  {"ru":"Иран (Исламская Республика)","en":"IRN"},
  {"ru":"Ирак","en":"IRQ"},
  {"ru":"Ирландия","en":"IRL"},
  {"ru":"Остров Мэн","en":"IMN"},
  {"ru":"Израиль","en":"ISR"},
  {"ru":"Италия","en":"ITA"},
  {"ru":"Ямайка","en":"JAM"},
  {"ru":"Япония","en":"JPN"},
  {"ru":"Джерси","en":"JEY"},
  {"ru":"Иордания","en":"JOR"},
  {"ru":"Казахстан","en":"KAZ"},
  {"ru":"Кения","en":"KEN"},
  {"ru":"Кирибати","en":"KIR"},
  {"ru":"Корейская Народно-Демократическая Республика","en":"PRK"},
  {"ru":"Республика Корея","en":"KOR"},
  {"ru":"Кувейт","en":"KWT"},
  {"ru":"Кыргызстан","en":"KGZ"},
  {"ru":"Лаосская Народно-Демократическая Республика","en":"LAO"},
  {"ru":"Латвия","en":"LVA"},
  {"ru":"Ливан","en":"LBN"},
  {"ru":"Лесото","en":"LSO"},
  {"ru":"Либерия","en":"LBR"},
  {"ru":"Ливия","en":"LBY"},
  {"ru":"Лихтенштейн","en":"LIE"},
  {"ru":"Литва","en":"LTU"},
  {"ru":"Люксембург","en":"LUX"},
  {"ru":"Макао","en":"MAC"},
  {"ru":"Мадагаскар","en":"MDG"},
  {"ru":"Малави","en":"MWI"},
  {"ru":"Малайзия","en":"MYS"},
  {"ru":"Мальдивы","en":"MDV"},
  {"ru":"Мали","en":"MLI"},
  {"ru":"Мальта","en":"MLT"},
  {"ru":"Маршалловы Острова","en":"MHL"},
  {"ru":"Мартиника","en":"MTQ"},
  {"ru":"Мавритания","en":"MRT"},
  {"ru":"Маврикий","en":"MUS"},
  {"ru":"Майотта","en":"MYT"},
  {"ru":"Мексика","en":"MEX"},
  {"ru":"Микронезия (Федеративные Штаты)","en":"FSM"},
  {"ru":"Молдова (Республика)","en":"MDA"},
  {"ru":"Монако","en":"MCO"},
  {"ru":"Монголия","en":"MNG"},
  {"ru":"Черногория","en":"MNE"},
  {"ru":"Монтсеррат","en":"MSR"},
  {"ru":"Марокко","en":"MAR"},
  {"ru":"Мозамбик","en":"MOZ"},
  {"ru":"Мьянма","en":"MMR"},
  {"ru":"Намибия","en":"NAM"},
  {"ru":"Науру","en":"NRU"},
  {"ru":"Непал","en":"NPL"},
  {"ru":"Нидерланды","en":"NLD"},
  {"ru":"Новая Каледония","en":"NCL"},
  {"ru":"Новая Зеландия","en":"NZL"},
  {"ru":"Никарагуа","en":"NIC"},
  {"ru":"Нигер","en":"NER"},
  {"ru":"Нигерия","en":"NGA"},
  {"ru":"Ниуэ","en":"NIU"},
  {"ru":"Остров Норфолк","en":"NFK"},
  {"ru":"Северная Македония","en":"MKD"},
  {"ru":"Северные Марианские острова","en":"MNP"},
  {"ru":"Норвегия","en":"NOR"},
  {"ru":"Оман","en":"OMN"},
  {"ru":"Пакистан","en":"PAK"},
  {"ru":"Палау","en":"PLW"},
  {"ru":"Палестина, Государство","en":"PSE"},
  {"ru":"Панама","en":"PAN"},
  {"ru":"Папуа-Новая Гвинея","en":"PNG"},
  {"ru":"Парагвай","en":"PRY"},
  {"ru":"Перу","en":"PER"},
  {"ru":"Филиппины","en":"PHL"},
  {"ru":"Питкэрн","en":"PCN"},
  {"ru":"Польша","en":"POL"},
  {"ru":"Португалия","en":"PRT"},
  {"ru":"Пуэрто-Рико","en":"PRI"},
  {"ru":"Катар","en":"QAT"},
  {"ru":"Реюньон","en":"REU"},
  {"ru":"Румыния","en":"ROU"},
  {"ru":"Российская Федерация","en":"RUS"},
  {"ru":"Руанда","en":"RWA"},
  {"ru":"Сен-Бартельми","en":"BLM"},
  {"ru":"Святая Елена, Вознесение и Тристан-да-Кунья","en":"SHN"},
  {"ru":"Сент-Китс и Невис","en":"KNA"},
  {"ru":"Сент-Люсия","en":"LCA"},
  {"ru":"Сен-Мартен (французская часть)","en":"MAF"},
  {"ru":"Сент-Пьер и Микелон","en":"SPM"},
  {"ru":"Сент-Винсент и Гренадины","en":"VCT"},
  {"ru":"Самоа","en":"WSM"},
  {"ru":"Сан-Марино","en":"SMR"},
  {"ru":"Сан-Томе и Принсипи","en":"STP"},
  {"ru":"Саудовская Аравия","en":"SAU"},
  {"ru":"Сенегал","en":"SEN"},
  {"ru":"Сербия","en":"SRB"},
  {"ru":"Сейшелы","en":"SYC"},
  {"ru":"Сьерра-Леоне","en":"SLE"},
  {"ru":"Сингапур","en":"SGP"},
  {"ru":"Синт-Мартен (нидерландская часть)","en":"SXM"},
  {"ru":"Словакия","en":"SVK"},
  {"ru":"Словения","en":"SVN"},
  {"ru":"Соломоновы Острова","en":"SLB"},
  {"ru":"Сомали","en":"SOM"},
  {"ru":"Южная Африка","en":"ZAF"},
  {"ru":"Южная Георгия и Южные Сандвичевы Острова","en":"SGS"},
  {"ru":"Южный Судан","en":"SSD"},
  {"ru":"Испания","en":"ESP"},
  {"ru":"Шри-Ланка","en":"LKA"},
  {"ru":"Судан","en":"SDN"},
  {"ru":"Суринам","en":"SUR"},
  {"ru":"Шпицберген и Ян-Майен","en":"SJM"},
  {"ru":"Свазиленд","en":"SWZ"},
  {"ru":"Швеция","en":"SWE"},
  {"ru":"Швейцария","en":"CHE"},
  {"ru":"Сирийская Арабская Республика","en":"SYR"},
  {"ru":"Тайвань (Китай)","en":"TWN"},
  {"ru":"Таджикистан","en":"TJK"},
  {"ru":"Объединённая Республика Танзания","en":"TZA"},
  {"ru":"Таиланд","en":"THA"},
  {"ru":"Тимор-Лешти","en":"TLS"},
  {"ru":"Того","en":"TGO"},
  {"ru":"Токелау","en":"TKL"},
  {"ru":"Тонга","en":"TON"},
  {"ru":"Тринидад и Тобаго","en":"TTO"},
  {"ru":"Тунис","en":"TUN"},
  {"ru":"Турция","en":"TUR"},
  {"ru":"Туркменистан","en":"TKM"},
  {"ru":"Острова Теркс и Кайкос","en":"TCA"},
  {"ru":"Тувалу","en":"TUV"},
  {"ru":"Уганда","en":"UGA"},
  {"ru":"Украина","en":"UKR"},
  {"ru":"Объединённые Арабские Эмираты","en":"ARE"},
  {"ru":"Великобритания","en":"GBR"},
  {"ru":"Соединённые Штаты Америки","en":"USA"},
  {"ru":"Малые отдалённые острова Соединённых Штатов","en":"UMI"},
  {"ru":"Уругвай","en":"URY"},
  {"ru":"Узбекистан","en":"UZB"},
  {"ru":"Вануату","en":"VUT"},
  {"ru":"Венесуэла (Боливарианская Республика)","en":"VEN"},
  {"ru":"Вьетнам","en":"VNM"},
  {"ru":"Виргинские Острова (Британские)","en":"VGB"},
  {"ru":"Виргинские Острова (США)","en":"VIR"},
  {"ru":"Уоллис и Футуна","en":"WLF"},
  {"ru":"Западная Сахара","en":"ESH"},
  {"ru":"Йемен","en":"YEM"},
  {"ru":"Замбия","en":"ZMB"},
  {"ru":"Зимбабве","en":"ZWE"}
]';
begin
  for elem in select json_array_elements(list)
  loop
    insert into temp_countries (name, parent_id)
    values (elem ->> 'ru', v_parent_id);
  end loop;

  call proc_mass_insert_countries();  
end
$$;